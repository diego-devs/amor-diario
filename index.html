<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Amor Diario</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#1a1215;--bg2:#231a1e;--bg3:#2d2226;
  --cream:#f0e6d3;--gold:#c9a96e;--gold-dim:#a88a55;
  --rose:#c27070;--rose-soft:#b5616180;--coral:#d4856a;
  --text:#ddd0c0;--text-dim:#a0918a;
}
html{scroll-behavior:smooth}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);font-weight:300;line-height:1.7;min-height:100vh}
a{color:var(--gold);text-decoration:none;transition:color .2s}
a:hover{color:var(--coral)}

/* Header */
.header{text-align:center;padding:3rem 1.5rem 2rem;border-bottom:1px solid var(--bg3)}
.header h1{font-family:'Cormorant Garamond',serif;font-size:clamp(2.2rem,6vw,3.8rem);font-weight:600;color:var(--cream);letter-spacing:.02em}
.header .heart{color:var(--rose);opacity:.7;font-size:.8em}
.header p{color:var(--text-dim);font-size:.95rem;margin-top:.4rem;font-style:italic}

/* Nav */
.nav{display:flex;justify-content:center;gap:.5rem;padding:1.2rem 1rem;flex-wrap:wrap;position:sticky;top:0;background:var(--bg);z-index:100;border-bottom:1px solid var(--bg3)}
.nav button{background:var(--bg2);color:var(--text-dim);border:1px solid var(--bg3);padding:.45rem 1.1rem;border-radius:2rem;font-size:.85rem;cursor:pointer;font-family:'Inter',sans-serif;transition:all .25s}
.nav button:hover,.nav button.active{background:var(--rose-soft);color:var(--cream);border-color:var(--rose)}

/* Search */
.search-wrap{max-width:480px;margin:1.5rem auto;padding:0 1.5rem}
.search-wrap input{width:100%;padding:.7rem 1.2rem;background:var(--bg2);border:1px solid var(--bg3);border-radius:2rem;color:var(--cream);font-size:.9rem;font-family:'Inter',sans-serif;outline:none;transition:border-color .2s}
.search-wrap input::placeholder{color:var(--text-dim)}
.search-wrap input:focus{border-color:var(--gold-dim)}

/* Articles */
.articles{max-width:720px;margin:0 auto;padding:1rem 1.5rem 4rem}
.article{background:var(--bg2);border:1px solid var(--bg3);border-radius:12px;margin-bottom:1.2rem;overflow:hidden;cursor:pointer;transition:transform .2s,border-color .3s;opacity:0;transform:translateY(18px);animation:fadeUp .5s ease forwards}
.article:hover{border-color:var(--rose-soft);transform:translateY(-2px)}
@keyframes fadeUp{to{opacity:1;transform:translateY(0)}}
.article-head{padding:1.4rem 1.6rem}
.article-date{font-size:.78rem;color:var(--gold-dim);text-transform:uppercase;letter-spacing:.08em;margin-bottom:.5rem}
.article-quote{font-family:'Cormorant Garamond',serif;font-size:1.35rem;font-weight:400;font-style:italic;color:var(--cream);line-height:1.5;margin-bottom:.4rem}
.article-author{font-size:.85rem;color:var(--rose);font-weight:400}
.article-body{max-height:0;overflow:hidden;transition:max-height .5s ease,padding .3s ease;padding:0 1.6rem}
.article.open .article-body{max-height:2000px;padding:0 1.6rem 1.6rem}
.article-title{font-family:'Cormorant Garamond',serif;font-size:1.1rem;font-weight:600;color:var(--gold);margin-bottom:.8rem}
.article-reflection{color:var(--text);font-size:.92rem;line-height:1.8;white-space:pre-line}
.article-song{margin-top:1.2rem;padding:1rem;background:var(--bg);border-radius:8px;border-left:3px solid var(--rose)}
.article-song .song-title{font-weight:500;color:var(--cream);font-size:.95rem}
.article-song .song-artist{color:var(--text-dim);font-size:.85rem;margin-bottom:.3rem}
.article-song .song-reason{color:var(--text-dim);font-size:.82rem;font-style:italic;margin-bottom:.5rem}
.article-song .song-links{display:flex;gap:.8rem}
.article-song .song-links a{font-size:.82rem;font-weight:500;padding:.3rem .7rem;border-radius:4px;border:1px solid var(--bg3);transition:all .2s}
.article-song .song-links a:hover{border-color:var(--gold)}
.article-tags{margin-top:.8rem;display:flex;flex-wrap:wrap;gap:.4rem}
.tag{font-size:.72rem;padding:.2rem .6rem;background:var(--bg);border-radius:1rem;color:var(--text-dim);border:1px solid var(--bg3)}
.expand-hint{font-size:.75rem;color:var(--text-dim);margin-top:.3rem}

/* Scroll top */
.scroll-top{position:fixed;bottom:2rem;right:2rem;width:44px;height:44px;border-radius:50%;background:var(--bg2);border:1px solid var(--bg3);color:var(--gold);font-size:1.2rem;cursor:pointer;opacity:0;pointer-events:none;transition:all .3s;display:flex;align-items:center;justify-content:center;z-index:200}
.scroll-top.show{opacity:1;pointer-events:auto}
.scroll-top:hover{background:var(--rose-soft);border-color:var(--rose)}

/* Empty */
.empty{text-align:center;padding:3rem;color:var(--text-dim);font-style:italic}

/* Responsive */
@media(max-width:480px){
  .article-head{padding:1.1rem 1.2rem}
  .article-quote{font-size:1.15rem}
  .article.open .article-body{padding:0 1.2rem 1.2rem}
}
</style>
</head>
<body>

<header class="header">
  <h1>Amor Diario <span class="heart">♡</span></h1>
  <p>49 días de reflexiones sobre el amor</p>
</header>

<nav class="nav" id="nav"></nav>

<div class="search-wrap">
  <input type="text" id="search" placeholder="Buscar por cita, autor, reflexión...">
</div>

<main class="articles" id="articles"></main>

<button class="scroll-top" id="scrollTop" aria-label="Volver arriba">↑</button>

<script>
let allArticles=[];
const months={1:'Enero',2:'Febrero'};

async function init(){
  const res=await fetch('articles/index.json');
  const index=await res.json();
  const loaded=await Promise.all(index.map(async e=>{
    const r=await fetch('articles/'+e.file);
    return r.json();
  }));
  allArticles=loaded.sort((a,b)=>b.date.localeCompare(a.date));
  buildNav();
  render(allArticles);
}

function buildNav(){
  const nav=document.getElementById('nav');
  const btnAll=mk('button','Todos');
  btnAll.classList.add('active');
  btnAll.onclick=()=>{setActive(btnAll);render(allArticles)};
  nav.appendChild(btnAll);
  for(const[m,name]of Object.entries(months)){
    const btn=mk('button',name);
    btn.onclick=()=>{setActive(btn);render(allArticles.filter(a=>a.month==m))};
    nav.appendChild(btn);
  }
}

function setActive(btn){document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));btn.classList.add('active')}

function mk(tag,text){const e=document.createElement(tag);if(text)e.textContent=text;return e}

function fmtDate(d){const dt=new Date(d+'T12:00:00');return dt.toLocaleDateString('es-ES',{weekday:'long',year:'numeric',month:'long',day:'numeric'})}

function render(arts){
  const c=document.getElementById('articles');
  c.innerHTML='';
  if(!arts.length){c.innerHTML='<div class="empty">No se encontraron artículos.</div>';return}
  arts.forEach((a,i)=>{
    const el=document.createElement('article');
    el.className='article';
    el.style.animationDelay=Math.min(i*60,600)+'ms';
    el.innerHTML=`
      <div class="article-head">
        <div class="article-date">${fmtDate(a.date)}</div>
        <div class="article-quote">"${esc(a.quote)}"</div>
        <div class="article-author">— ${esc(a.author)}</div>
        <div class="expand-hint">Toca para leer más</div>
      </div>
      <div class="article-body">
        <div class="article-title">${esc(a.title)}</div>
        <div class="article-reflection">${esc(a.reflection)}</div>
        <div class="article-song">
          <div class="song-title">♫ ${esc(a.song.title)}</div>
          <div class="song-artist">${esc(a.song.artist)}</div>
          <div class="song-reason">${esc(a.song.reason)}</div>
          <div class="song-links">
            <a href="${a.song.spotifyUrl}" target="_blank" rel="noopener">Spotify</a>
            <a href="${a.song.youtubeUrl}" target="_blank" rel="noopener">YouTube</a>
          </div>
        </div>
        ${a.tags?`<div class="article-tags">${a.tags.map(t=>`<span class="tag">${esc(t)}</span>`).join('')}</div>`:''}
      </div>`;
    el.querySelector('.article-head').addEventListener('click',()=>el.classList.toggle('open'));
    c.appendChild(el);
  });
}

function esc(s){const d=document.createElement('div');d.textContent=s;return d.innerHTML}

document.getElementById('search').addEventListener('input',function(){
  const q=this.value.toLowerCase().trim();
  if(!q){render(allArticles);return}
  render(allArticles.filter(a=>
    a.quote.toLowerCase().includes(q)||
    a.author.toLowerCase().includes(q)||
    a.reflection.toLowerCase().includes(q)||
    a.title.toLowerCase().includes(q)||
    (a.tags||[]).some(t=>t.toLowerCase().includes(q))
  ));
});

const stBtn=document.getElementById('scrollTop');
window.addEventListener('scroll',()=>stBtn.classList.toggle('show',window.scrollY>400));
stBtn.addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));

init();
</script>
</body>
</html>
